
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://azgaviperr.github.io/docs/3-nodes-swarm/Stacks/Shuffler/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2">
    
    
      
        <title>Shuffle - Azgaviperr Write-up</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="yellow">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shuffle" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Azgaviperr Write-up" class="md-header__button md-logo" aria-label="Azgaviperr Write-up" data-md-component="logo">
      
  <img src="../../../images/azgaviperr.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Azgaviperr Write-up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Shuffle
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../index.html" class="md-tabs__link">
      HOME
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link md-tabs__link--active">
        Swarming
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Thanks/Sponsors_and_Higlights/" class="md-tabs__link">
        Thanks
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Azgaviperr Write-up" class="md-nav__button md-logo" aria-label="Azgaviperr Write-up" data-md-component="logo">
      
  <img src="../../../images/azgaviperr.png" alt="logo">

    </a>
    Azgaviperr Write-up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        HOME
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Swarming
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Swarming" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Swarming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Architecture
      </a>
    </li>
  

          
            
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        Docker Swarm
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Docker Swarm" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Docker Swarm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DockerSwarm/01%20Installation/" class="md-nav__link">
        Building the Zerg Nest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DockerSwarm/02%20Ceph/" class="md-nav__link">
        Data Persistance and Sharing with Ceph
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      <label class="md-nav__link" for="__nav_2_3">
        Stacks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Stacks" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Stacks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer/" class="md-nav__link">
        Portainer
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Shuffle
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Shuffle
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      <label class="md-nav__link" for="__nav_2_4">
        Archives
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Archives" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Archives
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../GlusterFS/GlusterFS/" class="md-nav__link">
        Installing GlusterFS Server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources" class="md-nav__link">
        Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Thanks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Thanks" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Thanks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../Thanks/Sponsors_and_Higlights/" class="md-nav__link">
        Sponsors and Higlights
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="shuffle">Shuffle<a class="headerlink" href="#shuffle" title="Permanent link">#</a></h1>
<p><img alt="Shuffle" src="https://shuffler.io/images/logo.png" />
Shuffle is an Open Source SOAR I really appreciate as it does focus on CyberSecurity.
To know more about it go there: <a href="https://medium.com/shuffle-automation/introducing-shuffle-an-open-source-soar-platform-part-1-58a529de7d12">https://medium.com/shuffle-automation</a>
Or there : <a href="https://shuffler.io/">Official Website</a></p>
<p>Hi Frikky !!! Hoipefully, you will appreciate what you are seing here ^^</p>
<h1 id="preparaton">Preparaton<a class="headerlink" href="#preparaton" title="Permanent link">#</a></h1>
<h2 id="setup-data-locations">Setup data locations<a class="headerlink" href="#setup-data-locations" title="Permanent link">#</a></h2>
<h2 id="setup-docker-swarm">Setup Docker Swarm<a class="headerlink" href="#setup-docker-swarm" title="Permanent link">#</a></h2>
<p>Deploying Portainer and the Portainer Agent to manage a Swarm cluster is easy! You can directly deploy Portainer as a service in your Docker cluster. Note that this method will automatically deploy a single instance of the Portainer Server, and deploy the Portainer Agent as a global service on every node in your cluster.</p>
<div class="highlight"><pre><span></span><code># mkdir -p /mnt/configuration_data/compose_files/SOAR
</code></pre></div>
<h2 id="customisation">Customisation<a class="headerlink" href="#customisation" title="Permanent link">#</a></h2>
<p>At the time of this writing I may be the only one shufflying around with swarm :p
So there is not yet a stack ready compose file.</p>
<p>Let's create one <code>/mnt/configuration_data/compose_files/SOAR/shuffle.stack.yml</code>
<div class="highlight"><pre><span></span><code>version: &#39;3.8&#39;
services:
  backend:
    image: ghcr.io/frikky/shuffle-backend:latest
    environment:
      BACKEND_HOSTNAME: backend
      BACKEND_PORT: &#39;5001&#39;
      DATASTORE_EMULATOR_HOST: shuffle-database:8000
      DB_LOCATION: ./shuffle-database
      ENVIRONMENT_NAME: Shuffle
      FRONTEND_PORT: &#39;3001&#39;
      FRONTEND_PORT_HTTPS: &#39;3443&#39;
      HTTPS_PROXY: &#39;&#39;
      HTTP_PROXY: &#39;&#39;
      ORG_ID: Shuffle
      OUTER_HOSTNAME: backend
      SHUFFLE_APP_DOWNLOAD_LOCATION: https://github.com/frikky/shuffle-apps
      SHUFFLE_APP_FORCE_UPDATE: &#39;false&#39;
      SHUFFLE_APP_HOTLOAD_FOLDER: /shuffle-apps
      SHUFFLE_APP_HOTLOAD_LOCATION: ./shuffle-apps
      SHUFFLE_BASE_IMAGE_NAME: frikky
      SHUFFLE_BASE_IMAGE_REGISTRY: ghcr.io
      SHUFFLE_BASE_IMAGE_TAG_SUFFIX: &#39;-0.9.30&#39;
      SHUFFLE_CONTAINER_AUTO_CLEANUP: &#39;true&#39;
      SHUFFLE_DEFAULT_APIKEY: &#39;&#39;
      SHUFFLE_DOWNLOAD_AUTH_BRANCH: &#39;&#39;
      SHUFFLE_DOWNLOAD_AUTH_PASSWORD: &#39;&#39;
      SHUFFLE_DOWNLOAD_AUTH_USERNAME: &#39;&#39;
      SHUFFLE_DOWNLOAD_WORKFLOW_BRANCH: &#39;&#39;
      SHUFFLE_DOWNLOAD_WORKFLOW_LOCATION: &#39;&#39;
      SHUFFLE_DOWNLOAD_WORKFLOW_PASSWORD: &#39;&#39;
      SHUFFLE_DOWNLOAD_WORKFLOW_USERNAME: &#39;&#39;
      SHUFFLE_ELASTIC: &#39;true&#39;
      SHUFFLE_FILE_LOCATION: /shuffle-files
      SHUFFLE_OPENSEARCH_APIKEY: &#39;&#39;
      SHUFFLE_OPENSEARCH_CERTIFICATE_FILE: &#39;&#39;
      SHUFFLE_OPENSEARCH_CLOUDID: &#39;&#39;
      SHUFFLE_OPENSEARCH_PROXY: &#39;&#39;
      SHUFFLE_OPENSEARCH_SKIPSSL_VERIFY: &#39;true&#39;
      SHUFFLE_OPENSEARCH_URL: http://opensearch:9200
      SHUFFLE_PASS_APP_PROXY: &#39;FALSE&#39;
      SHUFFLE_PASS_WORKER_PROXY: &#39;TRUE&#39;
      SHUFFLE_ENCRYPTION_MODIFIER: a7cee5f9-8e55-4e05-98d4-59aa9595339b
      BASE_URL: https://shuffle.lab.local
      SSO_REDIRECT_URL: https://shuffle.lab.local
    #ports:
    # - 5001:5001
    volumes:
     - /var/run/docker.sock:/var/run/docker.sock
     - /mnt/swarm/container_data/Shuffle/shuffle-apps:/shuffle-apps
     - /mnt/swarm/container_data/Shuffle/shuffle-files:/shuffle-files
    networks:
     - shuffle
    depends_on:
     - opensearch 
    logging:
      driver: json-file
    deploy:
      placement:
        constraints:
          - node.labels.localisation==PROD  
      resources:
        limits:
          #cpus: &#39;0.5&#39;
          memory: 8G        
  frontend:
    image: ghcr.io/frikky/shuffle-frontend:latest
    healthcheck:
      test: curl -fs http://localhost:80 || exit 1
      interval: 30s
      timeout: 5s
      retries: 3    
    environment:
      BACKEND_HOSTNAME: backend
      BASE_URL: https://shuffle.lab.local
      SSO_REDIRECT_URL: https://shuffle.lab.local
    #ports:
    # - 3001:80
    # - 3443:443
    networks:
     - shuffle
     - reverseproxy
    logging:
      driver: json-file
    depends_on:
      - backend
    deploy: 
      placement:
        constraints:
          - node.labels.localisation==PROD         
      labels:
        - &quot;traefik.enable=true&quot;
        - &quot;traefik.http.routers.shuffle.rule=Host(`shuffle.lab.local`)&quot;
        - &quot;traefik.http.routers.shuffle.entrypoints=web-secure,web&quot;
        - &quot;traefik.http.routers.shuffle.tls=true&quot;
        - &quot;traefik.http.services.shuffle.loadbalancer.server.port=80&quot;
        - &quot;traefik.docker.network=reverseproxy&quot;

  opensearch:
    image: opensearchproject/opensearch:2
    healthcheck:
      test: curl -fs http://localhost:9200/_cat/health || exit 1
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 45s    
    environment:
      OPENSEARCH_JAVA_OPTS: -Xms4096m -Xmx4096m
      bootstrap.memory_lock: &#39;true&#39;
      cluster.initial_master_nodes: opensearch
      node.store.allow_mmap: &#39;false&#39;
      cluster.name: shuffle-cluster
      cluster.routing.allocation.disk.threshold_enabled: &#39;false&#39;
      discovery.seed_hosts: opensearch
      node.name: opensearch
      plugins.security.disabled: &#39;true&#39;
    ulimits:
      memlock:
        soft: -1
        hard: -1
      nofile:
        soft: 65536 
        hard: 65536      
    #ports:
     #- 9200:9200
    volumes:
     - /mnt/swarm/container_data/Shuffle/shuffle-database:/usr/share/opensearch/data
     #- /var/glusterfs/shuffle-database:/usr/share/opensearch/data
     - /mnt/swarm/container_data/Shuffle/shuffle-backup/opensearch:/mnt/backup
    networks:
     - shuffle
    logging:
      driver: json-file
    deploy:
      #endpoint_mode: dnsrr     
      placement:
        constraints:
          - node.labels.localisation==PROD 
      resources:
        limits:
          #cpus: &#39;0.5&#39;
          memory: 8G  

  orborus:
    #image: ghcr.io/frikky/shuffle-orborus:latest
    image: ghcr.io/frikky/shuffle-orborus:nightly
    environment:
      #SHUFFLE_APP_SDK_VERSION: 0.8.97
      SHUFFLE_WORKER_VERSION: latest     
      BASE_URL: http://tasks.backend:5001
      #BASE_URL: https://shuffle.lab.local
      CLEANUP: &#39;true&#39;
      DOCKER_API_VERSION: &#39;1.41&#39;
      ENVIRONMENT_NAME: Shuffle
      HTTPS_PROXY: &#39;&#39;
      HTTP_PROXY: &#39;&#39;
      ORG_ID: Shuffle
      SHUFFLE_BASE_IMAGE_NAME: frikky
      SHUFFLE_BASE_IMAGE_REGISTRY: ghcr.io
      SHUFFLE_BASE_IMAGE_TAG_SUFFIX: -0.8.80
      SHUFFLE_ORBORUS_EXECUTION_CONCURRENCY: &#39;50&#39;
      SHUFFLE_ORBORUS_EXECUTION_TIMEOUT: &#39;800&#39;
      SHUFFLE_PASS_APP_PROXY: &#39;FALSE&#39;
      SHUFFLE_PASS_WORKER_PROXY: &#39;FALSE&#39;
      SHUFFLE_SCALE_REPLICAS: 2
      SHUFFLE_SWARM_CONFIG: run
      SHUFFLE_LOGS_DISABLED: &quot;true&quot;
      SHUFFLE_SWARM_NETWORK_NAME: shuffle
      SSO_REDIRECT_URL: https://shuffle.lab.local
    volumes:
     - /var/run/docker.sock:/var/run/docker.sock
    networks:
     - shuffle
    depends_on:
      - backend     
    logging:
      driver: json-file
    deploy:
      placement:
        constraints:
          - node.labels.localisation==PROD

  oauth2-proxy:
     container_name: oauth2-proxy
     image: quay.io/oauth2-proxy/oauth2-proxy:latest
     command:  --config /oauth2-proxy.cfg
     hostname: oauth2-proxy
     networks:
     - shuffle
     - reverseproxy
     volumes:
       - /mnt/swarm/container_data/Shuffle/oauth2-proxy/oauth2-proxy.cfg:/oauth2-proxy.cfg
       - /mnt/swarm/container_data/Shuffle/oauth2-proxy/logs:/logs
       - /etc/ssl/certs/:/etc/ssl/certs/:ro
     restart: unless-stopped
     deploy: 
      placement:
        constraints:
          - node.labels.localisation==PROD         
      labels:
        - &quot;traefik.enable=true&quot;
        - &quot;traefik.http.routers.opensearch-secure.rule=Host(`shuffle.lab.local`)&quot;
        - &quot;traefik.http.routers.opensearch-secure.entrypoints=opensearch-secure&quot;
        - &quot;traefik.http.routers.opensearch-secure.tls=true&quot;
        - &quot;traefik.http.services.opensearch-secure.loadbalancer.server.port=4180&quot;
        - &quot;traefik.docker.network=reverseproxy&quot;
  dashboards:
    image: opensearchproject/opensearch-dashboards:2
    #ports:
     #- 5601:5601
    environment:
     OPENSEARCH_HOSTS: &#39;[&quot;http://opensearch:9200&quot;]&#39; # must be a string with no spaces when specified as an environment variable
     DISABLE_INSTALL_DEMO_CONFIG: &quot;true&quot;
     DISABLE_SECURITY_DASHBOARDS_PLUGIN: &quot;true&quot;
    networks:
     - shuffle
networks:
  shuffle:
    driver: overlay
    external: true    
  reverseproxy:
    driver: overlay
    external: true
</code></pre></div></p>
<h2 id="setup-data-locations_1">Setup data locations<a class="headerlink" href="#setup-data-locations_1" title="Permanent link">#</a></h2>
<p>This could be made as a command but I like to run first and echo instead of the "mkdir -p" to be sure I didn't made a mistake.</p>
<div class="highlight"><pre><span></span><code># grep &quot;/mnt/docker_data&quot; /mnt/configuration_data/compose_files/SOAR/shuffle-stack.yml | awk -F &quot;- &quot; &#39;{print $2&#39;} | awk -F &quot;:&quot; &#39;{ system(&quot;mkdir -p &quot;$1&quot;&quot;) }&#39;
</code></pre></div>
<h1 id="deploy-shuffle-stack">Deploy Shuffle stack<a class="headerlink" href="#deploy-shuffle-stack" title="Permanent link">#</a></h1>
<p>Deploy the Shuffle stack by running <code>docker stack deploy -c &lt;path -to-docker-compose.yml&gt; shuffle</code></p>
<p>Log into your new instance at any nodes on port https://node:3443.</p>
<h1 id="note">Note<a class="headerlink" href="#note" title="Permanent link">#</a></h1>
<p>Have you may have seen, all except database have a replica set to 3. This is done so we don't create a messy mess on DB if writing are done from different shuffle-database container at the same time on the same value which will lead to database corruption. Anyway, this container is up in 7 second in case of failure of the node ^^ .</p>
<p>App gonna be slow to run on it's first usage on all new nodes where Orborus is going to use the base image for the first time. As swarm distribute request around all replicas, sometime request gonna be fast as the node already run the image and sometime not.
This all Replica and Clustering of Shuffle is not yet production ready as it is not yet properly implemented.</p>
<p>I recommend using only one database and one Orborus for now.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../Portainer/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Portainer
            </div>
          </div>
        </a>
      
      
        <a href="../../GlusterFS/GlusterFS/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Installing GlusterFS Server
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>